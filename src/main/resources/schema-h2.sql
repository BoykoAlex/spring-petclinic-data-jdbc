DROP TABLE VET_SPECIALTY IF EXISTS;
DROP TABLE VET IF EXISTS;
DROP TABLE SPECIALTY IF EXISTS;
DROP TABLE VISIT IF EXISTS;
DROP TABLE PET IF EXISTS;
DROP TABLE TYPE IF EXISTS;
DROP TABLE OWNER IF EXISTS;


CREATE TABLE VET (
  ID         INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  FIRST_NAME VARCHAR(30),
  LAST_NAME  VARCHAR(30)
);
CREATE INDEX VET_LAST_NAME ON VET (LAST_NAME);

CREATE TABLE SPECIALTY (
  ID   INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  NAME VARCHAR(80)
);
CREATE INDEX SPECIALTY_NAME ON SPECIALTY (NAME);

CREATE TABLE VET_SPECIALTY (
  VET       INTEGER NOT NULL,
  SPECIALTY INTEGER NOT NULL
);
ALTER TABLE VET_SPECIALTY ADD CONSTRAINT FK_VET_SPECIALTY_VET FOREIGN KEY (VET) REFERENCES VET (ID);
ALTER TABLE VET_SPECIALTY ADD CONSTRAINT FK_VET_SPECIALTY_SPECIALTY FOREIGN KEY (SPECIALTY) REFERENCES SPECIALTY (ID);

CREATE TABLE PET_TYPE (
  ID   INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  NAME VARCHAR(80)
);
CREATE INDEX PET_TYPE_NAME ON PET_TYPE (NAME);

CREATE TABLE OWNER (
  ID         INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  FIRST_NAME VARCHAR(30),
  LAST_NAME  VARCHAR_IGNORECASE(30),
  ADDRESS    VARCHAR(255),
  CITY       VARCHAR(80),
  TELEPHONE  VARCHAR(20)
);
CREATE INDEX OWNER_LAST_NAME ON OWNER (LAST_NAME);

CREATE TABLE PET (
  ID         INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  NAME       VARCHAR(30),
  BIRTH_DATE DATE,
  TYPE_ID    INTEGER NOT NULL,
  OWNER_ID   INTEGER NOT NULL
);
ALTER TABLE PET ADD CONSTRAINT FK_PET_OWNER FOREIGN KEY (OWNER_ID) REFERENCES OWNER (ID);
ALTER TABLE PET ADD CONSTRAINT FK_PET_TYPE FOREIGN KEY (TYPE_ID) REFERENCES PET_TYPE (ID);
CREATE INDEX PET_NAME ON PET (NAME);

CREATE TABLE VISIT (
  ID          INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  PET_ID      INTEGER NOT NULL,
  VISIT_DATE  DATE,
  DESCRIPTION VARCHAR(255)
);
ALTER TABLE VISIT ADD CONSTRAINT FK_VISIT_PET FOREIGN KEY (PET_ID) REFERENCES PET (ID);
CREATE INDEX VISIT_PET_ID ON VISIT (PET_ID);
